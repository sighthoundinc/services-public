# ALPR Demo Application

A full featured demo, with SIO monitoring one or more video streams, AMQP client consuming the data from one or more instances, and front-end REST API making data available for searching past events.

Contact [support@sighthound.com](mailto:support@sighthound.com) with any questions, and visit our [Developer Portal](https://dev.sighthound.com) for more information.


## Components and containers

* live555_svc
    * Demo-specific container, serving two pre-recorded files over RTSP to emulate live video
    * Can be disabled or removed, if SIO container configuration is modified to point to alternative live streams

* analytics_svc
    * SIO container is the brains of the operation. It consumes live video and/or monitors a folder, and emits analytics along with recorded media.
    * The configuration provided with the sample runs four analytics pipelines:
        * `stream1`, `stream2` - two identical pipelines monitoring RTSP stream
        * `folderWatchUS` - pipeline monitoring a folder, and generating analytics for files deposited there in the context of US makes/models/license plates.
        * `folderWatchEU` - same, but using the context of EU
    * Configuration items of interest:
        * `./config/sio-pipelines.json` - specifies a set of pipelines to run, and configuration for each
        * `./config/sio-box-filter.json` - specifies box filter referenced by pipeline configurations

* rabbitmq_svc
    * RabbitMQ broker.
    * It is always a choice, whether to run a dedicated broker along with SIO, or point SIO (and the relevant clients) to your own instance used, perhaps, for other purposes.

* mcp_svc
    * MCP, or Media Control Point service, controls the access to, and live cycle of media items (images and videos) generated by SIO.

* dbclient_svc
    * A sample client, consuming analytics from the AMQP broker, and saving license plates we observe into a database.
    * Source code for it is located in `./consumer`

* rest_svc
    * A sample Flask-based REST client providing access to the database `dbclient_svc` writes to, as well as to provide web acccess for folder watch functionality of SIO
    * Source code for rest_svc is located in `./backend`

* UI Client (Python)
    * Source for it is in `./ui/python`
    * Can (and perhaps should) be ran remotely relatively to the docker-compose.
    * Make sure to install requirements with `pip3 install -r ./ui/python/requirements.txt`
    * Then run with `cd ./ui/python && python3 ALPRUI.py`

## General

Before getting started, you must copy your `sighthound-license.json` into the `./ALPRDemo/config/` folder. If you do not have a license, please contact [support@sighthound.com](mailto:support@sighthound.com).


Next, open a terminal, `cd` into the `./ALPRDemo/` folder, and run the following command to start the services:

```bash
docker compose up -d
```

If you have an NVIDIA GPU installed and properly configured, you can run the following command instead to enable GPU acceleration:

```bash
SIO_DOCKER_RUNTIME=nvidia docker compose up -d
```

## OS Compatibility

`SIO_DOCKER_TAG_VARIANT` environment variable used in `docker-compose` controls the flavor of SIO analytics container image. While on x86 systems thing largely work without setting it, on Jetson-based system, set it to the value most compatible with your base OS.

* `-r32.4.3-arm64v8` (built for hardware running Jetpack 4.4)
* `-r32.7.3-arm64v8` (built for hardware running Jetpack 4.6)
* `-r35.3.1-arm64v8` (work in progress, built for hardware running Jetpack 5.1)
* `-amd64` for x86 based systems

This variable may already be pre-set in more recent releases of ShOS / on Sighthound devices.

